(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{245:function(s,t,a){"use strict";a.r(t);var e=a(0),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"webpack-4-x"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack-4-x"}},[s._v("#")]),s._v(" webpack@4.x")]),s._v(" "),a("p",[s._v("[TOC]")]),s._v(" "),a("h2",{attrs:{id:"概述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),a("p",[s._v("功能：用于项目的自动化构建，能够根据依赖关系，将静态资源打包压缩等")]),s._v(" "),a("p",[s._v("当页面引入的静态资源多了以后：")]),s._v(" "),a("ul",[a("li",[s._v("会产生大量的二次请求；")]),s._v(" "),a("li",[s._v("依赖关系错综复杂")])]),s._v(" "),a("p",[s._v("webpack 自身只支持处理 JS，使用 loader 能够让 webpack 处理 JS 以外的文件\n包括：出入口文件、模式、loader、plugin")]),s._v(" "),a("p",[s._v("先简单地概述一下 webpack 的工作原理：webpack 读取入口文件（entry），然后递归查找所依赖的模块(module)，构建成一个“依赖图”，然后根据配置中的加载器(loader)和打包策略来对模块进行编译。")]),s._v(" "),a("p",[s._v("但是如果中间有文件发生变化了，上面所述的整个递归遍历流程会重新再进行一次。")]),s._v(" "),a("h2",{attrs:{id:"安装与配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装与配置"}},[s._v("#")]),s._v(" 安装与配置")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i webpack webpack-cli -D")]),s._v(" 命令进行安装")]),s._v(" "),a("li",[s._v("默认配置文件为 "),a("code",[s._v("./webpack.config.js")]),s._v(" 或 "),a("code",[s._v("./webpackfile.js")])]),s._v(" "),a("li",[s._v("webpack 默认只支持 JS 文件的打包，其他文件类型需要安装对应的 loader")])]),s._v(" "),a("h3",{attrs:{id:"mode-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mode-字段"}},[s._v("#")]),s._v(" mode 字段")]),s._v(" "),a("h3",{attrs:{id:"module-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#module-字段"}},[s._v("#")]),s._v(" module 字段")]),s._v(" "),a("ul",[a("li",[s._v("rules：")])]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[s._v("rules"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.vue$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" use"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"vue-loader"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.css$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" use"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"style-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"css-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.less$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" use"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"style-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"css-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"less-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.js$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" use"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    loader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"babel-loader"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// include: path.resolve("snake/src"),')]),s._v("\n    exclude"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/node_modules/")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("h3",{attrs:{id:"devserver-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#devserver-字段"}},[s._v("#")]),s._v(" devServer 字段")]),s._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[s._v("proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"/api"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    target"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://localhost:3000"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    pathRewrite"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"/api"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将/api替换掉")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 访问：http://localhost:8080/api/test，就会被代理到：http://localhost:3000/test 上")]),s._v("\n")])])]),a("h3",{attrs:{id:"plugins-字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#plugins-字段"}},[s._v("#")]),s._v(" plugins 字段")]),s._v(" "),a("ul",[a("li",[s._v("设置 HTML 模板：html-webpack-plugin 插件")]),s._v(" "),a("li",[s._v("设置全局变量：webpack.ProvidePlugin 插件")])]),s._v(" "),a("h2",{attrs:{id:"命令行指令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令行指令"}},[s._v("#")]),s._v(" 命令行指令")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i wabpack-cli -D")]),s._v(" 安装打包依赖")]),s._v(" "),a("li",[a("code",[s._v("npx webpack")]),s._v(" 命令进行打包，")]),s._v(" "),a("li",[s._v("该命令会运行"),a("code",[s._v("./node_modules/webpack/bin/webpack.js")]),s._v(" 文件")]),s._v(" "),a("li",[a("code",[s._v("npx webpack --config <configFile>")]),s._v(" 手动指定配置文件")]),s._v(" "),a("li",[s._v("默认情况下会将 "),a("code",[s._v("./src/")]),s._v(" 目录下的文件打包到 "),a("code",[s._v("./dist/main.js")]),s._v("，入口文件 "),a("code",[s._v("index.js")])])]),s._v(" "),a("h2",{attrs:{id:"本地静态服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地静态服务"}},[s._v("#")]),s._v(" 本地静态服务")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i webpack-dev-server -D")]),s._v(" 安装开发服务依赖")]),s._v(" "),a("li",[a("code",[s._v("npx webpack-dev-server")]),s._v(" 命令启动静态服务\n打包文件的存放目录为项目根目录，保存在内存中而不是硬盘中")])]),s._v(" "),a("h2",{attrs:{id:"编译功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译功能"}},[s._v("#")]),s._v(" 编译功能")]),s._v(" "),a("h3",{attrs:{id:"编译-html-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译-html-文件"}},[s._v("#")]),s._v(" 编译 HTML 文件")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i html-webpack-plugin -D")]),s._v(" 安装 HTML 插件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")]),s._v(" "),a("li",[s._v("在打包 JS 文件时也会打包 HTML 文件，并自动引入打包后的 JS 文件")])]),s._v(" "),a("h3",{attrs:{id:"编译-css-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译-css-文件"}},[s._v("#")]),s._v(" 编译 CSS 文件")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i css-loader style-loader less-loader -D")]),s._v(" 安装 CSS 插件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")]),s._v(" "),a("li",[s._v("在 JS 源文件中引入 CSS 文件")])]),s._v(" "),a("h3",{attrs:{id:"抽离-css-样式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#抽离-css-样式"}},[s._v("#")]),s._v(" 抽离 CSS 样式")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i mini-css-extract-plugin -D")]),s._v(" 安装插件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")]),s._v(" "),a("li",[a("code",[s._v("css-loader?modules")]),s._v(" 为样式表启用模块化（css-in-js）")]),s._v(" "),a("li",[a("code",[s._v("css-loader?localIdentName=[name]-[local]")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("[name]")]),s._v(" 样式表名称")]),s._v(" "),a("li",[a("code",[s._v("[path]")]),s._v(" 样式表相对于项目根目录的路径")]),s._v(" "),a("li",[a("code",[s._v("[local]")]),s._v(" 样式表类名名称")]),s._v(" "),a("li",[a("code",[s._v("[hash:<length>]")]),s._v(" 样式表哈希值")])])]),s._v(" "),a("li",[s._v("在打包时会将 CSS 样式抽离到一个文件中，并在 HTML 中引用")])]),s._v(" "),a("h3",{attrs:{id:"压缩-css-文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#压缩-css-文件"}},[s._v("#")]),s._v(" 压缩 CSS 文件")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i optimize-css-assets-webpack-plugin -D")]),s._v(" 安装 CSS 压缩插件\n"),a("code",[s._v("npm i uglifyjs-webpack-plugin -D")]),s._v(" 安装 JS 压缩插件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置（需要使用生产模式）")])]),s._v(" "),a("h3",{attrs:{id:"添加浏览器前缀"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加浏览器前缀"}},[s._v("#")]),s._v(" 添加浏览器前缀")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i postcss-loader autoprefixer -D")]),s._v(" 安装插件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v("、"),a("code",[s._v("./postcss.config.js")]),s._v(" 中进行配置")])]),s._v(" "),a("h3",{attrs:{id:"编译-less-sass-stylus"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译-less-sass-stylus"}},[s._v("#")]),s._v(" 编译 less/sass/stylus")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("npm i less less-loader -D")]),s._v(" 安装 less 插件\n"),a("code",[s._v("npm i node-sass sass-loader -D")]),s._v(" 安装 sass 插件\n"),a("code",[s._v("npm i stylus stylus-loader -D")]),s._v(" 安装 stylus 插件")])]),s._v(" "),a("li",[a("p",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")])]),s._v(" "),a("li",[a("p",[s._v("在 JS 源文件中引入 less/sass/stylus 文件")])])]),s._v(" "),a("h3",{attrs:{id:"处理静态资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#处理静态资源"}},[s._v("#")]),s._v(" 处理静态资源")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i url-loader file-loader -D")])]),s._v(" "),a("li",[s._v("url-loader 用于将图片转换为 base64，file-loader 用于打包静态资源，生成 public URL")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")]),s._v(" "),a("li",[a("code",[s._v('{ test: /\\.png$/, use: "url-loader" }')])]),s._v(" "),a("li",[s._v("定义多大的图片转换为 base64")]),s._v(" "),a("li",[a("code",[s._v("use: [option: { limit:50000, outputPath: 'images' }]")])])]),s._v(" "),a("h3",{attrs:{id:"转换高级语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#转换高级语法"}},[s._v("#")]),s._v(" 转换高级语法")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i babel-loader -D")]),s._v(" 安装 loader\n"),a("code",[s._v("npm i @babel/core @babel/cli -D")]),s._v(" 安装 babel 核心模块\n"),a("code",[s._v("@babel/preset-env")]),s._v(" 可以根据配置的目标运行环境，自动将 ES2015+ 的代码转换为 ES5。\n"),a("code",[s._v("@babel/polyfill")]),s._v(" 用于加载 "),a("em",[s._v("polyfill")]),s._v(" 库，解决了 Babel 不转换新 API 的问题\n"),a("code",[s._v("@babel/runtime")]),s._v(" 提供编译模块的工具函数，启用插件 babel-plugin-transform-runtime 后，Babel 就会使用 babel-runtime 下的工具函数")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")]),s._v(" "),a("li",[a("code",[s._v("module: { rules: [{ exclude: /node_modules/ }] }")]),s._v(" 编译时忽略 node_modules 文件夹")])]),s._v(" "),a("h3",{attrs:{id:"代码校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码校验"}},[s._v("#")]),s._v(" 代码校验")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("npm i eslint eslint-loader -D")]),s._v(" 安装 babel 核心模块")]),s._v(" "),a("li",[s._v("下载 "),a("code",[s._v(".eslintrc.json")]),s._v(" 规则文件")]),s._v(" "),a("li",[s._v("在 "),a("code",[s._v("./webpack.config.js")]),s._v(" 中进行配置")])]),s._v(" "),a("h2",{attrs:{id:"路径别名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路径别名"}},[s._v("#")]),s._v(" 路径别名")]),s._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[s._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\textensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".jsx"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 在引入文件时这几种后缀名可以省略")]),s._v("\n  alias"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"@"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./src"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"异常处理记录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异常处理记录"}},[s._v("#")]),s._v(" 异常处理记录")]),s._v(" "),a("h3",{attrs:{id:"cannot-find-module-webpack-lib-node-nodetemplateplugin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cannot-find-module-webpack-lib-node-nodetemplateplugin"}},[s._v("#")]),s._v(" Cannot find module 'webpack/lib/node/NodeTemplatePlugin'")]),s._v(" "),a("ul",[a("li",[s._v("npm remove webpack -g")]),s._v(" "),a("li",[s._v("npm i webpack --save-dev（不要全局安装）")]),s._v(" "),a("li",[s._v("有建议将上一句分为如下两句操作（获得多数人认可）：")]),s._v(" "),a("li",[s._v("npm i webpack -g")]),s._v(" "),a("li",[s._v("npm link webpack --save-dev")])]),s._v(" "),a("h3",{attrs:{id:"引入-node-模块报错"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#引入-node-模块报错"}},[s._v("#")]),s._v(" 引入 Node 模块报错")]),s._v(" "),a("ul",[a("li",[s._v("在配置文件中添加："),a("code",[s._v('node: { <moduleName>: "empty" }')])])]),s._v(" "),a("h2",{attrs:{id:"eslint"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#eslint"}},[s._v("#")]),s._v(" ESLint")]),s._v(" "),a("p",[s._v("<cintent>")])])}),[],!1,null,null,null);t.default=n.exports}}]);